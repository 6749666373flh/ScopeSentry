import{d as e,dE as l,r as a,s as o,o as u,i as s,w as t,e as n,a as i,G as r,f as v,c as d,R as m,F as p,ad as c,z as f,y as g,t as b,l as _,ai as w}from"./index-ChGT_YCB.js";import{a as y,E as h}from"./el-form-D2bRQxI0.js";import{E as V,a as j}from"./el-col-i_K16CKa.js";import{E as k}from"./el-divider-Dm9ByY6A.js";import{E as x}from"./el-tag-uqONbW_Z.js";import"./el-popper-PhuldJD-.js";import"./el-virtual-list-CNowGpHm.js";import{E}from"./el-select-v2-wtxCX1rW.js";import{j as F,o as z,T as C}from"./index-asYEI0eh.js";import{u as U,c as D}from"./index-iHvimrm9.js";const G={class:"flex gap-2"},M=e({__name:"Detail",props:{closeDialog:{type:Function},getList:{type:Function},pocForm:{}},setup(e){const{t:M}=_(),N=[F(),z],R=e,{pocForm:q}=l(R),I=a({...q.value}),L=o({name:[{required:!0,message:M("poc.nameMsg"),trigger:"blur"}],level:[{required:!0,message:M("poc.contentMsg"),trigger:"blur"}]}),T=[{value:"critical",label:"critical"},{value:"high",label:"high"},{value:"medium",label:"medium"},{value:"low",label:"low"},{value:"info",label:"info"},{value:"unknown",label:"unknown"}],A=a(!1),B=a(),K=a([...q.value.tags]),O=a(""),P=a(!1),H=a(),J=()=>{P.value=!0,w((()=>{H.value.input.focus()}))},Q=()=>{O.value&&K.value.push(O.value),P.value=!1,O.value=""};return(e,l)=>(u(),s(i(h),{model:I.value,"label-width":"120px",rules:L,"status-icon":"",ref_key:"ruleFormRef",ref:B},{default:t((()=>[n(i(y),{label:i(M)("poc.pocName"),prop:"name"},{default:t((()=>[n(i(r),{modelValue:I.value.name,"onUpdate:modelValue":l[0]||(l[0]=e=>I.value.name=e),placeholder:i(M)("poc.nameMsg")},null,8,["modelValue","placeholder"])])),_:1},8,["label"]),n(i(y),{label:i(M)("poc.content"),prop:"content"},{default:t((()=>[n(i(C),{modelValue:I.value.content,"onUpdate:modelValue":l[1]||(l[1]=e=>I.value.content=e),style:{height:"600px",width:"100%"},autofocus:!0,"indent-with-tab":!0,"tab-size":2,extensions:N},null,8,["modelValue"])])),_:1},8,["label"]),n(i(y),{label:i(M)("poc.level")},{default:t((()=>[n(i(E),{modelValue:I.value.level,"onUpdate:modelValue":l[2]||(l[2]=e=>I.value.level=e),placeholder:"Please select level",options:T},null,8,["modelValue"])])),_:1},8,["label"]),n(i(y),{label:"TAG"},{default:t((()=>[v("div",G,[(u(!0),d(p,null,m(K.value,(e=>(u(),s(i(x),{key:e,closable:"","disable-transitions":!1,onClose:l=>(e=>{K.value.splice(K.value.indexOf(e),1)})(e)},{default:t((()=>[g(b(e),1)])),_:2},1032,["onClose"])))),128)),P.value?(u(),s(i(r),{key:0,ref_key:"InputRef",ref:H,modelValue:O.value,"onUpdate:modelValue":l[3]||(l[3]=e=>O.value=e),class:"w-20",size:"small",onKeyup:c(Q,["enter"]),onBlur:Q},null,8,["modelValue"])):(u(),s(i(f),{key:1,class:"button-new-tag",size:"small",onClick:J},{default:t((()=>[g(" + New Tag ")])),_:1}))])])),_:1}),n(i(k)),n(i(j),null,{default:t((()=>[n(i(V),{span:2,offset:8},{default:t((()=>[n(i(y),null,{default:t((()=>[n(i(f),{type:"primary",onClick:l[4]||(l[4]=e=>(async e=>{A.value=!0,e&&await e.validate((async(e,l)=>{if(e){let e;e=""!=I.value.id?await U(I.value.id,I.value.name,I.value.content,I.value.level,K.value):await D(I.value.name,I.value.content,I.value.level,K.value),200===e.code&&(R.getList(),R.closeDialog()),A.value=!1}else A.value=!1}))})(B.value)),loading:A.value},{default:t((()=>[g(b(i(M)("task.save")),1)])),_:1},8,["loading"])])),_:1})])),_:1})])),_:1})])),_:1},8,["model","rules"]))}});export{M as _};
