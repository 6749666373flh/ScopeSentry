import{d as e,bt as a,r as l,s as t,K as o,o as n,i as u,w as s,e as i,a as c,L as d,y as p,j as r,t as m,M as v,l as f,Q as b}from"./index-B4Nyjh3H.js";import{E as g,a as k}from"./el-checkbox-DAPJr8Xi.js";/* empty css                          */import{E as h}from"./el-divider-C1wqG4VS.js";import{a as _,E as V}from"./el-form-DDCfLIJB.js";import{E as w,a as S}from"./el-col-ChTZtubL.js";import{E as x}from"./el-switch-Cn0FzV_x.js";import"./el-tooltip-l0sNRNKZ.js";import{E as y}from"./el-popper-DBt0ZFPB.js";import{a as j,E as N}from"./el-radio-group-exGM2d1B.js";import"./el-tag-DS_6W9-f.js";import{E as U}from"./el-select-v2-DYay7EKY.js";import{E as M}from"./el-input-number-CzlgwRVT.js";import{E as A}from"./el-text-D_MjvMVh.js";import{a as E}from"./index-Dn7RvWpV.js";import{b as T}from"./index-fmL6XoL3.js";import{c as I,e as C}from"./index-DE3qlntH.js";import{b as L}from"./index-Bm26evLc.js";const P=e({__name:"AddTask",props:{closeDialog:{type:Function},getList:{type:Function},vTaskForm:{},create:{type:Boolean},schedule:{type:Boolean},taskid:{}},setup(e){const{t:P}=f(),F=e,{vTaskForm:q}=a(F),B=l({...q.value}),D=t({name:[{required:!0,message:P("task.msgTaskName"),trigger:"blur"}],target:[{required:!0,message:P("task.msgTarget"),trigger:"blur"}],node:[{required:!0,message:P("task.nodeMsg"),trigger:"blur"}]}),J=l(!1),K=l(),z=t([]),H=t([]),Q=t([]);o((()=>{(async()=>{const e=await E();e.data.list.length>0?(W.value=!1,e.data.list.forEach((e=>{z.push({value:e,label:e})}))):(W.value=!0,b.warning(P("node.onlineNodeMsg")))})(),(async()=>{const e=await T();e.data.list.length>0&&(Q.push({value:"All Poc",label:"All Poc"}),e.data.list.forEach((e=>{Q.push({value:e.id,label:e.name})})))})(),(async()=>{const e=await L("",1,1e4);e.data.list.length>0&&e.data.list.forEach((e=>{H.push({value:e.id,label:e.name})}))})()}));const R=l(!1),W=l(!1),Y=e=>{R.value=!1,e?(B.value.allNode=!0,B.value.node=[],z.forEach((e=>B.value.node.push(e.value)))):(B.value.allNode=!1,B.value.node=[])};return(e,a)=>(n(),u(c(V),{model:B.value,"label-width":"auto",rules:D,"status-icon":"",ref_key:"ruleFormRef",ref:K,disabled:!e.create},{default:s((()=>[i(c(_),{label:c(P)("task.taskName"),prop:"name"},{default:s((()=>[i(c(d),{modelValue:B.value.name,"onUpdate:modelValue":a[0]||(a[0]=e=>B.value.name=e),placeholder:c(P)("task.msgTaskName")},null,8,["modelValue","placeholder"])])),_:1},8,["label"]),i(c(_),{label:c(P)("task.taskTarget"),prop:"target"},{default:s((()=>[i(c(d),{modelValue:B.value.target,"onUpdate:modelValue":a[1]||(a[1]=e=>B.value.target=e),placeholder:c(P)("task.msgTarget"),type:"textarea",rows:"10"},null,8,["modelValue","placeholder"])])),_:1},8,["label"]),i(c(y),{content:c(P)("task.selectNodeMsg"),placement:"top"},{default:s((()=>[i(c(_),{label:c(P)("task.nodeSelect"),prop:"node"},{default:s((()=>[i(c(U),{modelValue:B.value.node,"onUpdate:modelValue":a[3]||(a[3]=e=>B.value.node=e),filterable:"",options:z,placeholder:"Please select node",style:{width:"80%"},multiple:"","tag-type":"success","collapse-tags":"","collapse-tags-tooltip":"","max-collapse-tags":7},{header:s((()=>[i(c(g),{modelValue:B.value.allNode,"onUpdate:modelValue":a[2]||(a[2]=e=>B.value.allNode=e),disabled:W.value,indeterminate:R.value,onChange:Y},{default:s((()=>[p(" All ")])),_:1},8,["modelValue","disabled","indeterminate"])])),_:1},8,["modelValue","options"])])),_:1},8,["label"])])),_:1},8,["content"]),i(c(S),null,{default:s((()=>[i(c(w),{span:12},{default:s((()=>[i(c(_),{label:c(P)("project.scheduledTasks")},{default:s((()=>[i(c(y),{effect:"dark",content:c(P)("project.msgScheduledTasks"),placement:"top"},{default:s((()=>[i(c(x),{modelValue:B.value.scheduledTasks,"onUpdate:modelValue":a[4]||(a[4]=e=>B.value.scheduledTasks=e),"inline-prompt":"","active-text":c(P)("common.switchAction"),"inactive-text":c(P)("common.switchInactive")},null,8,["modelValue","active-text","inactive-text"])])),_:1},8,["content"])])),_:1},8,["label"])])),_:1}),B.value.scheduledTasks?(n(),u(c(w),{key:0,span:12},{default:s((()=>[i(c(_),{label:c(P)("project.cycle"),prop:"type"},{default:s((()=>[i(c(M),{modelValue:B.value.hour,"onUpdate:modelValue":a[5]||(a[5]=e=>B.value.hour=e),min:1,"controls-position":"right",size:"small"},null,8,["modelValue"]),i(c(A),{style:{position:"relative",left:"16px"}},{default:s((()=>[p("Hour")])),_:1})])),_:1},8,["label"])])),_:1})):r("",!0)])),_:1}),i(c(h),{"content-position":"center",style:{width:"60%",left:"20%"}},{default:s((()=>[p(m(c(P)("task.duplicates")),1)])),_:1}),i(c(S),null,{default:s((()=>[i(c(w),{span:24},{default:s((()=>[i(c(_),{label:c(P)("task.duplicates"),prop:"type"},{default:s((()=>[i(c(j),{modelValue:B.value.duplicates,"onUpdate:modelValue":a[6]||(a[6]=e=>B.value.duplicates=e)},{default:s((()=>[i(c(N),{label:"None",name:"duplicates",checked:!0,value:"None"}),i(c(y),{effect:"dark",content:c(P)("task.duplicatesMsg"),placement:"top"},{default:s((()=>[i(c(N),{label:c(P)("task.duplicatesSubdomain"),name:"duplicates",value:"subdomain"},null,8,["label"])])),_:1},8,["content"]),i(c(y),{effect:"dark",content:c(P)("task.duplicatesPortMsg"),placement:"top"},{default:s((()=>[i(c(N),{label:c(P)("task.duplicatesPort"),name:"duplicates",value:"port"},null,8,["label"])])),_:1},8,["content"])])),_:1},8,["modelValue"])])),_:1},8,["label"])])),_:1})])),_:1}),i(c(h),{"content-position":"center",style:{width:"60%",left:"20%"}},{default:s((()=>[p(m(c(P)("subdomain.subdomainName")),1)])),_:1}),i(c(S),null,{default:s((()=>[i(c(w),{span:6},{default:s((()=>[i(c(_),{label:c(P)("task.subdomainScan")},{default:s((()=>[i(c(x),{modelValue:B.value.subdomainScan,"onUpdate:modelValue":a[7]||(a[7]=e=>B.value.subdomainScan=e),"inline-prompt":"","active-text":c(P)("common.switchAction"),"inactive-text":c(P)("common.switchInactive")},null,8,["modelValue","active-text","inactive-text"])])),_:1},8,["label"])])),_:1}),i(c(w),{span:12},{default:s((()=>[B.value.subdomainScan?(n(),u(c(_),{key:0,label:c(P)("task.config"),prop:"type"},{default:s((()=>[i(c(k),{modelValue:B.value.subdomainConfig,"onUpdate:modelValue":a[8]||(a[8]=e=>B.value.subdomainConfig=e)},{default:s((()=>[i(c(g),{label:"Subfinder",name:"subdomainConfig"}),i(c(g),{label:"Ksubdomain",name:"subdomainConfig"})])),_:1},8,["modelValue"])])),_:1},8,["label"])):r("",!0)])),_:1})])),_:1}),i(c(h),{"content-position":"center",style:{width:"60%",left:"20%"}},{default:s((()=>[p(m(c(P)("task.portScan")),1)])),_:1}),i(c(S),null,{default:s((()=>[i(c(w),{span:6},{default:s((()=>[i(c(_),{label:c(P)("task.portScan")},{default:s((()=>[i(c(x),{modelValue:B.value.portScan,"onUpdate:modelValue":a[9]||(a[9]=e=>B.value.portScan=e),"inline-prompt":"","active-text":c(P)("common.switchAction"),"inactive-text":c(P)("common.switchInactive")},null,8,["modelValue","active-text","inactive-text"])])),_:1},8,["label"])])),_:1}),i(c(w),{span:12},{default:s((()=>[B.value.portScan?(n(),u(c(_),{key:0,label:c(P)("task.portSelect"),prop:"portScan"},{default:s((()=>[i(c(U),{modelValue:B.value.ports,"onUpdate:modelValue":a[10]||(a[10]=e=>B.value.ports=e),filterable:"",options:H,placeholder:"Please select port",style:{width:"80%"}},null,8,["modelValue","options"])])),_:1},8,["label"])):r("",!0)])),_:1})])),_:1}),i(c(h),{"content-position":"center",style:{width:"60%",left:"20%"}},{default:s((()=>[p(m(c(P)("dirScan.dirScanName")),1)])),_:1}),i(c(_),{label:c(P)("dirScan.dirScanName")},{default:s((()=>[i(c(x),{modelValue:B.value.dirScan,"onUpdate:modelValue":a[11]||(a[11]=e=>B.value.dirScan=e),"inline-prompt":"","active-text":c(P)("common.switchAction"),"inactive-text":c(P)("common.switchInactive")},null,8,["modelValue","active-text","inactive-text"])])),_:1},8,["label"]),i(c(h),{"content-position":"center",style:{width:"60%",left:"20%"}},{default:s((()=>[p(m(c(P)("crawler.crawlerName")),1)])),_:1}),i(c(S),null,{default:s((()=>[i(c(w),{span:6},{default:s((()=>[i(c(y),{effect:"dark",content:c(P)("task.msgUrl"),placement:"top"},{default:s((()=>[i(c(_),{label:c(P)("task.url")},{default:s((()=>[i(c(x),{modelValue:B.value.urlScan,"onUpdate:modelValue":a[12]||(a[12]=e=>B.value.urlScan=e),"inline-prompt":"","active-text":c(P)("common.switchAction"),"inactive-text":c(P)("common.switchInactive")},null,8,["modelValue","active-text","inactive-text"])])),_:1},8,["label"])])),_:1},8,["content"])])),_:1}),i(c(w),{span:6},{default:s((()=>[B.value.urlScan?(n(),u(c(_),{key:0,label:c(P)("task.sensitiveInfoScan"),prop:"type"},{default:s((()=>[i(c(x),{modelValue:B.value.sensitiveInfoScan,"onUpdate:modelValue":a[13]||(a[13]=e=>B.value.sensitiveInfoScan=e),"inline-prompt":"","active-text":c(P)("common.switchAction"),"inactive-text":c(P)("common.switchInactive")},null,8,["modelValue","active-text","inactive-text"])])),_:1},8,["label"])):r("",!0)])),_:1}),i(c(w),{span:6},{default:s((()=>[i(c(y),{effect:"dark",content:c(P)("task.waybackUrlMsg"),placement:"top"},{default:s((()=>[B.value.urlScan?(n(),u(c(_),{key:0,label:"waybackurl",prop:"type"},{default:s((()=>[i(c(x),{modelValue:B.value.waybackurl,"onUpdate:modelValue":a[14]||(a[14]=e=>B.value.waybackurl=e),"inline-prompt":"","active-text":c(P)("common.switchAction"),"inactive-text":c(P)("common.switchInactive")},null,8,["modelValue","active-text","inactive-text"])])),_:1})):r("",!0)])),_:1},8,["content"])])),_:1}),i(c(w),{span:12,offset:6},{default:s((()=>[B.value.urlScan?(n(),u(c(_),{key:0,label:c(P)("task.pageMonitoring"),prop:"type"},{default:s((()=>[i(c(j),{modelValue:B.value.pageMonitoring,"onUpdate:modelValue":a[15]||(a[15]=e=>B.value.pageMonitoring=e)},{default:s((()=>[i(c(N),{label:"None",name:"pageMonitoring"}),i(c(y),{effect:"dark",content:c(P)("task.msgPageMonitoringAll"),placement:"top"},{default:s((()=>[i(c(N),{label:"All",name:"pageMonitoring",checked:!0})])),_:1},8,["content"]),i(c(y),{effect:"dark",content:c(P)("task.msgPageMonitoringJs"),placement:"top"},{default:s((()=>[i(c(N),{label:"JS",name:"pageMonitoring"})])),_:1},8,["content"])])),_:1},8,["modelValue"])])),_:1},8,["label"])):r("",!0)])),_:1})])),_:1}),i(c(_),{label:c(P)("crawler.crawlerName"),prop:"type"},{default:s((()=>[i(c(y),{effect:"dark",content:c(P)("task.msgCrawler"),placement:"top"},{default:s((()=>[i(c(x),{modelValue:B.value.crawlerScan,"onUpdate:modelValue":a[16]||(a[16]=e=>B.value.crawlerScan=e),"inline-prompt":"","active-text":c(P)("common.switchAction"),"inactive-text":c(P)("common.switchInactive")},null,8,["modelValue","active-text","inactive-text"])])),_:1},8,["content"])])),_:1},8,["label"]),i(c(h),{"content-position":"center",style:{width:"60%",left:"20%"}},{default:s((()=>[p(m(c(P)("task.vulScan")),1)])),_:1}),i(c(S),null,{default:s((()=>[i(c(w),{span:6},{default:s((()=>[i(c(_),{label:c(P)("task.vulScan")},{default:s((()=>[i(c(x),{modelValue:B.value.vulScan,"onUpdate:modelValue":a[17]||(a[17]=e=>B.value.vulScan=e),"inline-prompt":"","active-text":c(P)("common.switchAction"),"inactive-text":c(P)("common.switchInactive")},null,8,["modelValue","active-text","inactive-text"])])),_:1},8,["label"])])),_:1}),i(c(w),{span:18},{default:s((()=>[B.value.vulScan?(n(),u(c(_),{key:0,label:c(P)("task.vulList"),prop:"type"},{default:s((()=>[i(c(U),{modelValue:B.value.vulList,"onUpdate:modelValue":a[18]||(a[18]=e=>B.value.vulList=e),filterable:"",options:Q,placeholder:"Please select vul",style:{width:"80%"},multiple:"","collapse-tags":"","collapse-tags-tooltip":"","tag-type":"info","max-collapse-tags":3},null,8,["modelValue","options"])])),_:1},8,["label"])):r("",!0)])),_:1})])),_:1}),i(c(h)),i(c(S),null,{default:s((()=>[i(c(w),{span:2,offset:10},{default:s((()=>[i(c(_),null,{default:s((()=>[i(c(v),{type:"primary",onClick:a[19]||(a[19]=e=>(async e=>{J.value=!0,e&&await e.validate((async(e,a)=>{B.value.allNode||(B.value.allNode=!1),e?(""===F.taskid?200===(await I(B.value.name,B.value.target,B.value.node,B.value.allNode,B.value.subdomainScan,B.value.subdomainConfig,B.value.urlScan,B.value.duplicates,B.value.sensitiveInfoScan,B.value.pageMonitoring,B.value.crawlerScan,B.value.vulScan,B.value.vulList,B.value.portScan,B.value.ports,B.value.dirScan,B.value.waybackurl,B.value.scheduledTasks,B.value.hour)).code&&(F.getList(),F.closeDialog()):200===(await C(F.taskid,B.value.name,B.value.target,B.value.node,B.value.allNode,B.value.subdomainScan,B.value.subdomainConfig,B.value.urlScan,B.value.duplicates,B.value.sensitiveInfoScan,B.value.pageMonitoring,B.value.crawlerScan,B.value.vulScan,B.value.vulList,B.value.portScan,B.value.ports,B.value.dirScan,B.value.waybackurl,B.value.scheduledTasks,B.value.hour)).code&&(F.getList(),F.closeDialog()),J.value=!1):J.value=!1}))})(K.value)),loading:J.value},{default:s((()=>[p(m(c(P)("task.save")),1)])),_:1},8,["loading"])])),_:1})])),_:1})])),_:1})])),_:1},8,["model","rules","disabled"]))}});export{P as _};
