import{P as e,g as t}from"./PanelGroup-DcYHTtf3.js";import{s as a,v as l,x as o,y as s,d as r,z as n,A as i,r as u,B as p,C as d,o as m,i as c,w as f,f as v,n as y,a as g,D as h,F as _,G as x,j as b,H as j,t as k,e as w,I as S,J as C,K as T,L as B,M as N,N as V,O as U,P as A,Q as E,c as I,R as F,S as M,l as z,_ as P}from"./index-M10etHi6.js";import{E as $,a as H}from"./el-col-CNNqU05O.js";import{E as R}from"./el-card-t9G4RzyN.js";import{E as D}from"./el-progress-BNI1IzWh.js";import{E as L}from"./el-text-Bjb0AW85.js";import"./el-tooltip-l0sNRNKZ.js";import{u as O,E as G}from"./el-popper-D4B4f19J.js";/* empty css                   */import{E as J,a as Q}from"./el-form-A-pj7LuS.js";import{_ as K}from"./Table.vue_vue_type_script_lang-9x4PpCFP.js";import{E as X}from"./el-tag-DC4eDhDo.js";import{_ as Y}from"./Dialog.vue_vue_type_style_index_0_lang-Cx7rWX1S.js";import{g as Z}from"./index-CYT5Tfx5.js";import{g as q}from"./index-CFqx989n.js";import{c as W}from"./index-CE6JPvTK.js";import"./el-skeleton-item-J7rneK2h.js";import"./CountTo.vue_vue_type_script_setup_true_lang-CbNRiJz_.js";import"./index-MoA9wocQ.js";import"./castArray-D86glhSN.js";import"./el-table-column-Ct9f4goZ.js";import"./index-BEjIPMze.js";import"./debounce-DMlGG38r.js";import"./el-checkbox-C3AB5jlc.js";import"./isArrayLikeObject-CmTAjD1K.js";import"./raf-ChTn_6oX.js";import"./el-pagination-DKV_XtBQ.js";import"./el-select-CQG17R-n.js";import"./strings-DKCbZfke.js";import"./useInput-DFHJnJFD.js";import"./el-image-viewer-CAmikf02.js";import"./el-empty-DtGCvYos.js";import"./tsxHelper-Cy1d83nC.js";import"./el-dropdown-item-6vek0JLM.js";import"./refs-DEjEOHCT.js";import"./index-D4oHVQnn.js";const ee=a({title:String,confirmButtonText:String,cancelButtonText:String,confirmButtonType:{type:String,values:l,default:"primary"},cancelButtonType:{type:String,values:l,default:"text"},icon:{type:o,default:()=>s},iconColor:{type:String,default:"#f90"},hideIcon:{type:Boolean,default:!1},hideAfter:{type:Number,default:200},teleported:O.teleported,persistent:O.persistent,width:{type:[String,Number],default:150}}),te={confirm:e=>e instanceof MouseEvent,cancel:e=>e instanceof MouseEvent},ae=r({name:"ElPopconfirm"});const le=N(B(r({...ae,props:ee,emits:te,setup(e,{emit:t}){const a=e,{t:l}=n(),o=i("popconfirm"),s=u(),r=()=>{var e,t;null==(t=null==(e=s.value)?void 0:e.onClose)||t.call(e)},B=p((()=>({width:d(a.width)}))),N=e=>{t("confirm",e),r()},V=e=>{t("cancel",e),r()},U=p((()=>a.confirmButtonText||l("el.popconfirm.confirmButtonText"))),A=p((()=>a.cancelButtonText||l("el.popconfirm.cancelButtonText")));return(e,t)=>(m(),c(g(G),T({ref_key:"tooltipRef",ref:s,trigger:"click",effect:"light"},e.$attrs,{"popper-class":`${g(o).namespace.value}-popover`,"popper-style":g(B),teleported:e.teleported,"fallback-placements":["bottom","top","right","left"],"hide-after":e.hideAfter,persistent:e.persistent}),{content:f((()=>[v("div",{class:y(g(o).b())},[v("div",{class:y(g(o).e("main"))},[!e.hideIcon&&e.icon?(m(),c(g(h),{key:0,class:y(g(o).e("icon")),style:_({color:e.iconColor})},{default:f((()=>[(m(),c(x(e.icon)))])),_:1},8,["class","style"])):b("v-if",!0),j(" "+k(e.title),1)],2),v("div",{class:y(g(o).e("action"))},[w(g(S),{size:"small",type:"text"===e.cancelButtonType?"":e.cancelButtonType,text:"text"===e.cancelButtonType,onClick:V},{default:f((()=>[j(k(g(A)),1)])),_:1},8,["type","text"]),w(g(S),{size:"small",type:"text"===e.confirmButtonType?"":e.confirmButtonType,text:"text"===e.confirmButtonType,onClick:N},{default:f((()=>[j(k(g(U)),1)])),_:1},8,["type","text"])],2)],2)])),default:f((()=>[e.$slots.reference?C(e.$slots,"reference",{key:0}):b("v-if",!0)])),_:3},16,["popper-class","popper-style","teleported","hide-after","persistent"]))}}),[["__file","popconfirm.vue"]])),oe={class:"flex flex-col gap-2"},se=P(r({__name:"Analysis",setup(a){const{t:l}=z(),o=u(!0),s=V([{field:"nodeName",label:l("node.nodeName")},{field:"taskCount",label:l("node.taskCount"),formatter:(e,t,a)=>U(X,{round:!0,effect:"dark"},(()=>a))},{field:"nodeStatus",label:l("node.nodeStatus"),formatter:(e,t,a)=>U(X,{type:"1"===a?"success":"2"===a?"warning":"danger",effect:"dark"},(()=>l("1"==a?"node.statusRun":"2"==a?"node.statusStop":"node.statusError")))}]),r=V([{field:"name",label:l("task.taskName")},{field:"taskNum",label:l("task.taskCount"),formatter:(e,t,a)=>U(X,{round:!0,effect:"dark"},(()=>a))},{field:"progress",label:l("task.taskProgress"),formatter:(e,t,a)=>U(D,{percentage:a,type:"line",striped:!0,status:a<100?"":"success",stripedFlow:a<100})},{field:"creatTime",label:l("task.createTime")}]),n=V([{field:"nodeName",label:l("node.nodeName")},{field:"nodeUsageCpu",label:l("node.nodeUsageCpu"),formatter:(e,t,a)=>{let l=parseFloat(a);return l=parseFloat(l.toFixed(2)),U(D,{percentage:l,type:"dashboard",color:l<50?"#26a33f":l<=80?"#fe9900":"#df2800"})}},{field:"nodeUsageMemory",label:l("node.nodeUsageMemory"),formatter:(e,t,a)=>{let l=parseFloat(a);return l=parseFloat(l.toFixed(2)),U(D,{percentage:l,type:"dashboard",color:l<50?"#26a33f":l<80?"#fe9900":"#df2800"})}}]),i=V([{field:"name",label:l("common.name")},{field:"cversion",label:l("common.cversion")},{field:"lversion",label:l("common.lversion"),formatter:(e,t,a)=>{if(e.cversion!=e.lversion){O.value=!0;const t=e.msg.split("\\n");let l="";return t.forEach((e=>{l+=`<div>${e}</div>`})),U(G,{placement:"top",content:l,rawContent:!0},[U(L,{type:"danger"},a)])}return U(L,a)}}]);let p=u([]);const d=u([]),y=async()=>{try{const e=await Z();e&&e.data&&Array.isArray(e.data.list)&&(d.value=e.data.list.map((e=>({nodeName:e.name,taskCount:e.running,nodeStatus:e.state,nodeUsageCpu:e.cpuNum,nodeUsageMemory:e.memNum}))),p.value=V(e.data.list.map((e=>({nodeName:e.name,nodeUsageCpu:e.cpuNum,nodeUsageMemory:e.memNum})))))}catch(e){}finally{o.value=!1}},h=u([]),_=async()=>{const e=await q("",1,10);h.value=V(e.data.list.map((e=>({name:e.name,taskNum:e.taskNum,progress:e.progress,creatTime:e.creatTime}))))},x=u([]),C=async()=>{await Promise.all([y(),_()]),o.value=!1};(async()=>{const e=await t();x.value=V(e.data.list.map((e=>({name:e.name,cversion:e.cversion,lversion:e.lversion,msg:e.msg}))))})(),C();const T=setInterval(C,1e4);A((()=>{clearInterval(T)}));const B=u(""),N=async()=>{localStorage.getItem("plugin_key")?te.value=!0:ae.value=!0},P=async()=>{if(B.value){200==(await W(B.value)).code&&(localStorage.setItem("plugin_key",B.value),ae.value=!1,te.value=!0)}},O=u(!1),ee=u({server:"https://github.com/Autumn-27/ScopeSentry/archive/refs/heads/main.zip",scan:""}),te=u(!1),ae=u(!1);async function se(){}return(t,a)=>{const o=E("BaseButton");return m(),I(M,null,[w(e),w(g(H),{gutter:20,justify:"space-between"},{default:f((()=>[w(g($),{xl:12,lg:12,md:24,sm:24,xs:24},{default:f((()=>[w(g(R),{shadow:"hover",class:"mb-20px"},{header:f((()=>[v("span",null,k(g(l)("dashboard.nodeInfo")),1)])),default:f((()=>[w(g(K),{columns:s,data:d.value,stripe:"",border:!1,height:250},null,8,["columns","data"])])),_:1})])),_:1}),w(g($),{xl:12,lg:12,md:24,sm:24,xs:24},{default:f((()=>[w(g(R),{shadow:"hover",class:"mb-20px"},{header:f((()=>[v("span",null,k(g(l)("dashboard.taskInfo")),1)])),default:f((()=>[w(g(K),{columns:r,data:h.value,stripe:"",border:!1,height:250,"tooltip-options":{offset:1,showArrow:!1,effect:"dark",enterable:!1,showAfter:0,popperOptions:{},popperClass:"test",placement:"bottom",hideAfter:0,disabled:!0}},null,8,["columns","data"])])),_:1})])),_:1}),w(g($),{span:12},{default:f((()=>[w(g(R),{shadow:"hover",class:"mb-25px"},{header:f((()=>[v("div",null,[v("span",null,k(g(l)("node.nodeUsageStatus")),1)])])),default:f((()=>[w(g(K),{columns:n,data:g(p),highlightCurrentRow:!1,stripe:"",border:!1,height:600},null,8,["columns","data"])])),_:1})])),_:1}),w(g($),{span:12},{default:f((()=>[w(g(R),{shadow:"hover",class:"mb-25px"},{header:f((()=>[w(g(H),null,{default:f((()=>[w(g($),{span:12},{default:f((()=>[v("div",null,[v("span",null,k(g(l)("common.version")),1),O.value?(m(),c(g(L),{key:0,type:"danger",size:"small",style:{position:"relative",left:"1rem"}},{default:f((()=>[j("*"+k(g(l)("common.updatemsg")),1)])),_:1})):b("",!0)])])),_:1}),O.value?(m(),c(g($),{key:0,span:3,offset:8},{default:f((()=>[w(g(le),{title:"Are you sure?",onConfirm:N},{reference:f((()=>[w(g(S),{color:"#626aef"},{default:f((()=>[j(k(g(l)("common.update")),1)])),_:1})])),_:1})])),_:1})):b("",!0)])),_:1})])),default:f((()=>[w(g(K),{columns:i,data:x.value,stripe:"",border:!1,height:600},null,8,["columns","data"])])),_:1})])),_:1})])),_:1}),w(g(Y),{modelValue:te.value,"onUpdate:modelValue":a[2]||(a[2]=e=>te.value=e),title:"Update",center:"",style:{"border-radius":"15px","box-shadow":"5px 5px 10px rgba(0, 0, 0, 0.3)"},maxHeight:430},{default:f((()=>[w(g(L),{type:"danger",size:"small",style:{position:"relative",left:"1rem"}},{default:f((()=>[j("*更新目前只支持docker容器搭建的程序，输入的url地址确保docker内可访问，节点最新版在github中releases的linux版本")])),_:1}),w(g(J),{model:ee.value,"label-width":"120px",class:"upload-form"},{default:f((()=>[w(g(Q),{label:"server url"},{default:f((()=>[w(g(F),{modelValue:ee.value.server,"onUpdate:modelValue":a[0]||(a[0]=e=>ee.value.server=e),placeholder:"server url"},null,8,["modelValue"])])),_:1}),w(g(Q),{label:"scan url"},{default:f((()=>[w(g(F),{modelValue:ee.value.scan,"onUpdate:modelValue":a[1]||(a[1]=e=>ee.value.scan=e),placeholder:"scan url(https://github.com/Autumn-27/ScopeSentry-Scan/releases/download/vx.x.x/ScopeSentry-Scan_linux_amd64_vx.x.x.zip)"},null,8,["modelValue"])])),_:1}),w(g(Q),null,{default:f((()=>[w(g(S),{type:"primary",onClick:se},{default:f((()=>[j("Submit")])),_:1})])),_:1})])),_:1},8,["model"])])),_:1},8,["modelValue"]),w(g(Y),{modelValue:ae.value,"onUpdate:modelValue":a[4]||(a[4]=e=>ae.value=e),title:g(l)("plugin.key"),center:"",width:"30%",style:{"max-width":"400px",height:"200px"}},{default:f((()=>[v("div",oe,[w(g(G),{class:"item",effect:"dark",content:g(l)("plugin.keyMsg"),placement:"top"},{default:f((()=>[w(g(F),{modelValue:B.value,"onUpdate:modelValue":a[3]||(a[3]=e=>B.value=e)},null,8,["modelValue"])])),_:1},8,["content"]),w(o,{onClick:P,type:"primary",class:"w-full"},{default:f((()=>[j("确定")])),_:1})])])),_:1},8,["modelValue","title"])],64)}}}),[["__scopeId","data-v-9fae725d"]]);export{se as default};
