import{P as e,g as a}from"./PanelGroup-C0QzSn2v.js";import{d as t,r as s,s as o,v as r,x as l,o as n,c as m,e as d,w as i,a as p,f as u,t as c,i as f,y as g,j as v,F as b,l as h,_ as j}from"./index-C75x1W_q.js";import{E as _,a as y}from"./el-col-DgdPSEMf.js";import{E as k}from"./el-card-B54lVHaN.js";import{E as x}from"./el-progress-BURropay.js";import{E as w}from"./el-text-BJjANnhE.js";import"./el-tooltip-l0sNRNKZ.js";import{E as N}from"./el-popper-B4X-nZEc.js";import{_ as C}from"./Table.vue_vue_type_script_lang-a6bm3afC.js";import{E as A}from"./el-tag-sJbhYsGb.js";import{g as E}from"./index-Q0xmndJ5.js";import{g as U}from"./index-B76HdAF8.js";import"./el-skeleton-item-C0o6pbKg.js";import"./CountTo.vue_vue_type_script_setup_true_lang-Csu-4JyG.js";import"./index-CU1g1Qmh.js";import"./el-table-column-DCN4Lp6f.js";import"./index-BjT9vIQp.js";import"./isEqual-BHgupMbx.js";import"./debounce-B1dqoIRt.js";import"./el-checkbox-DNn0VEEC.js";import"./isArrayLikeObject-f_cYQsBX.js";import"./raf-C1Ndsx6C.js";import"./el-select-DpD7cK3l.js";import"./useInput-CL83Kqek.js";import"./el-image-viewer-18KIcjBl.js";import"./tsxHelper-eKzA9uIm.js";import"./el-dropdown-item-lD4tMeV-.js";import"./castArray-CbnyB5vx.js";import"./refs-B1ngtnm_.js";import"./index-BOnf2JCp.js";const F=j(t({__name:"Analysis",setup(t){const{t:j}=h(),F=s(!0),T=o([{field:"nodeName",label:j("node.nodeName")},{field:"taskCount",label:j("node.taskCount"),formatter:(e,a,t)=>r(A,{round:!0,effect:"dark"},(()=>t))},{field:"nodeStatus",label:j("node.nodeStatus"),formatter:(e,a,t)=>r(A,{type:"1"===t?"success":"2"===t?"warning":"danger",effect:"dark"},(()=>j("1"==t?"node.statusRun":"2"==t?"node.statusStop":"node.statusError")))}]),I=o([{field:"name",label:j("task.taskName")},{field:"taskNum",label:j("task.taskCount"),formatter:(e,a,t)=>r(A,{round:!0,effect:"dark"},(()=>t))},{field:"progress",label:j("task.taskProgress"),formatter:(e,a,t)=>r(x,{percentage:t,type:"line",striped:!0,status:t<100?"":"success",stripedFlow:t<100})},{field:"creatTime",label:j("task.createTime")}]),S=o([{field:"nodeName",label:j("node.nodeName")},{field:"nodeUsageCpu",label:j("node.nodeUsageCpu"),formatter:(e,a,t)=>{let s=parseFloat(t);return s=parseFloat(s.toFixed(2)),r(x,{percentage:s,type:"dashboard",color:s<50?"#26a33f":s<=80?"#fe9900":"#df2800"})}},{field:"nodeUsageMemory",label:j("node.nodeUsageMemory"),formatter:(e,a,t)=>{let s=parseFloat(t);return s=parseFloat(s.toFixed(2)),r(x,{percentage:s,type:"dashboard",color:s<50?"#26a33f":s<80?"#fe9900":"#df2800"})}}]),M=o([{field:"name",label:j("common.name")},{field:"cversion",label:j("common.cversion")},{field:"lversion",label:j("common.lversion"),formatter:(e,a,t)=>{if(e.cversion!=e.lversion){K.value=!0;const a=e.msg.split("\\n");let s="";return a.forEach((e=>{s+=`<div>${e}</div>`})),r(N,{placement:"top",content:s,rawContent:!0},[r(w,{type:"danger"},t)])}return r(w,t)}}]);let P=s([]);const q=s([]),z=async()=>{try{const e=await E();e&&e.data&&Array.isArray(e.data.list)&&(q.value=e.data.list.map((e=>({nodeName:e.name,taskCount:e.running,nodeStatus:e.state,nodeUsageCpu:e.cpuNum,nodeUsageMemory:e.memNum}))),P.value=o(e.data.list.map((e=>({nodeName:e.name,nodeUsageCpu:e.cpuNum,nodeUsageMemory:e.memNum})))))}catch(e){}finally{F.value=!1}},G=s([]),O=async()=>{const e=await U("",1,10);G.value=o(e.data.list.map((e=>({name:e.name,taskNum:e.taskNum,progress:e.progress,creatTime:e.creatTime}))))},R=s([]),$=async()=>{await Promise.all([z(),O()]),F.value=!1};(async()=>{const e=await a();R.value=o(e.data.list.map((e=>({name:e.name,cversion:e.cversion,lversion:e.lversion,msg:e.msg}))))})(),$();const H=setInterval($,1e4);l((()=>{clearInterval(H)}));const K=s(!1);return(a,t)=>(n(),m(b,null,[d(e),d(p(y),{gutter:20,justify:"space-between"},{default:i((()=>[d(p(_),{xl:12,lg:12,md:24,sm:24,xs:24},{default:i((()=>[d(p(k),{shadow:"hover",class:"mb-20px"},{header:i((()=>[u("span",null,c(p(j)("dashboard.nodeInfo")),1)])),default:i((()=>[d(p(C),{columns:T,data:q.value,stripe:"",border:!1,height:250},null,8,["columns","data"])])),_:1})])),_:1}),d(p(_),{xl:12,lg:12,md:24,sm:24,xs:24},{default:i((()=>[d(p(k),{shadow:"hover",class:"mb-20px"},{header:i((()=>[u("span",null,c(p(j)("dashboard.taskInfo")),1)])),default:i((()=>[d(p(C),{columns:I,data:G.value,stripe:"",border:!1,height:250,"tooltip-options":{offset:1,showArrow:!1,effect:"dark",enterable:!1,showAfter:0,popperOptions:{},popperClass:"test",placement:"bottom",hideAfter:0,disabled:!0}},null,8,["columns","data"])])),_:1})])),_:1}),d(p(_),{span:12},{default:i((()=>[d(p(k),{shadow:"hover",class:"mb-25px"},{header:i((()=>[u("div",null,[u("span",null,c(p(j)("node.nodeUsageStatus")),1)])])),default:i((()=>[d(p(C),{columns:S,data:p(P),highlightCurrentRow:!1,stripe:"",border:!1,height:600},null,8,["columns","data"])])),_:1})])),_:1}),d(p(_),{span:12},{default:i((()=>[d(p(k),{shadow:"hover",class:"mb-25px"},{header:i((()=>[d(p(y),null,{default:i((()=>[d(p(_),{span:12},{default:i((()=>[u("div",null,[u("span",null,c(p(j)("common.version")),1),K.value?(n(),f(p(w),{key:0,type:"danger",size:"small",style:{position:"relative",left:"1rem"}},{default:i((()=>[g("*"+c(p(j)("common.updatemsg")),1)])),_:1})):v("",!0)])])),_:1})])),_:1})])),default:i((()=>[d(p(C),{columns:M,data:R.value,stripe:"",border:!1,height:600},null,8,["columns","data"])])),_:1})])),_:1})])),_:1})],64))}}),[["__scopeId","data-v-9e7545ec"]]);export{F as default};
