import{l as a,r as t,a2 as e,a as s,W as n,Z as l,a0 as o,aq as c}from"./index-M10etHi6.js";const{t:i}=a(),u=a=>{const{immediate:u=!0}=a,m=t(!1),r=t(1),d=t(20),g=t(0),y=t([]);e((()=>r.value),(()=>{f.getList()})),e((()=>d.value),(()=>{1===s(r)||(r.value=1),f.getList()})),n((()=>{u&&f.getList()}));const v=t(),p=t(),w=async()=>{await c();const a=s(v);return a},f={getList:async()=>{m.value=!0;try{const t=await(null==a?void 0:a.fetchDataApi());t&&(y.value=t.list,g.value=t.total||0)}catch(t){}finally{m.value=!1}},setProps:async(a={})=>{const t=await w();null==t||t.setProps(a)},setColumn:async a=>{const t=await w();null==t||t.setColumn(a)},addColumn:async(a,t)=>{const e=await w();null==e||e.addColumn(a,t)},delColumn:async a=>{const t=await w();null==t||t.delColumn(a)},getElTableExpose:async()=>(await w(),s(p)),refresh:()=>{f.getList()},delList:async t=>{const{fetchDelApi:e}=a;e&&l.confirm(i("common.delMessage"),i("common.delWarning"),{confirmButtonText:i("common.delOk"),cancelButtonText:i("common.delCancel"),type:"warning"}).then((async()=>{if(await e()){o.success(i("common.delSuccess"));const a=(s(g)%s(d)===t||1===s(d))&&s(r)>1?s(r)-1:s(r);r.value=a,f.getList()}}))}};return{tableRegister:(a,t)=>{v.value=a,p.value=s(t)},tableMethods:f,tableState:{currentPage:r,pageSize:d,total:g,dataList:y,loading:m}}};export{u};
