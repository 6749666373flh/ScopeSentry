import{d as e,dG as l,r as a,N as o,o as u,i as s,w as t,e as n,a as i,R as r,f as v,c as m,a5 as d,S as p,am as c,I as f,H as g,t as b,l as _,aq as w}from"./index-M10etHi6.js";import{a as h,E as y}from"./el-form-A-pj7LuS.js";import{E as V,a as j}from"./el-col-CNNqU05O.js";import{E as k}from"./el-divider-DaZuXLuF.js";import{E as x}from"./el-tag-DC4eDhDo.js";import"./el-popper-D4B4f19J.js";import"./el-virtual-list-D-52HN6k.js";import{E}from"./el-select-v2-C0bSj804.js";import{j as F,o as C,T as N}from"./index-DWUGARdz.js";import{u as U,c as q}from"./index-CecUnJ7w.js";const z={class:"flex gap-2"},D=e({__name:"Detail",props:{closeDialog:{type:Function},getList:{type:Function},pocForm:{}},setup(e){const{t:D}=_(),G=[F(),C],I=e,{pocForm:M}=l(I),R=a({...M.value}),L=o({name:[{required:!0,message:D("poc.nameMsg"),trigger:"blur"}],level:[{required:!0,message:D("poc.contentMsg"),trigger:"blur"}]}),T=[{value:"critical",label:"critical"},{value:"high",label:"high"},{value:"medium",label:"medium"},{value:"low",label:"low"},{value:"info",label:"info"},{value:"unknown",label:"unknown"}],A=a(!1),B=a(),H=a([...M.value.tags]),K=a(""),O=a(!1),P=a(),S=()=>{O.value=!0,w((()=>{P.value.input.focus()}))},J=()=>{K.value&&H.value.push(K.value),O.value=!1,K.value=""};return(e,l)=>(u(),s(i(y),{model:R.value,"label-width":"120px",rules:L,"status-icon":"",ref_key:"ruleFormRef",ref:B},{default:t((()=>[n(i(h),{label:i(D)("poc.pocName"),prop:"name"},{default:t((()=>[n(i(r),{modelValue:R.value.name,"onUpdate:modelValue":l[0]||(l[0]=e=>R.value.name=e),placeholder:i(D)("poc.nameMsg")},null,8,["modelValue","placeholder"])])),_:1},8,["label"]),n(i(h),{label:i(D)("poc.content"),prop:"content"},{default:t((()=>[n(i(N),{modelValue:R.value.content,"onUpdate:modelValue":l[1]||(l[1]=e=>R.value.content=e),style:{height:"600px",width:"100%"},autofocus:!0,"indent-with-tab":!0,"tab-size":2,extensions:G},null,8,["modelValue"])])),_:1},8,["label"]),n(i(h),{label:i(D)("poc.level")},{default:t((()=>[n(i(E),{modelValue:R.value.level,"onUpdate:modelValue":l[2]||(l[2]=e=>R.value.level=e),placeholder:"Please select level",options:T},null,8,["modelValue"])])),_:1},8,["label"]),n(i(h),{label:"TAG"},{default:t((()=>[v("div",z,[(u(!0),m(p,null,d(H.value,(e=>(u(),s(i(x),{key:e,closable:"","disable-transitions":!1,onClose:l=>(e=>{H.value.splice(H.value.indexOf(e),1)})(e)},{default:t((()=>[g(b(e),1)])),_:2},1032,["onClose"])))),128)),O.value?(u(),s(i(r),{key:0,ref_key:"InputRef",ref:P,modelValue:K.value,"onUpdate:modelValue":l[3]||(l[3]=e=>K.value=e),class:"w-20",size:"small",onKeyup:c(J,["enter"]),onBlur:J},null,8,["modelValue"])):(u(),s(i(f),{key:1,class:"button-new-tag",size:"small",onClick:S},{default:t((()=>[g(" + New Tag ")])),_:1}))])])),_:1}),n(i(k)),n(i(j),null,{default:t((()=>[n(i(V),{span:2,offset:8},{default:t((()=>[n(i(h),null,{default:t((()=>[n(i(f),{type:"primary",onClick:l[4]||(l[4]=e=>(async e=>{A.value=!0,e&&await e.validate((async(e,l)=>{if(e){let e;e=""!=R.value.id?await U(R.value.id,R.value.name,R.value.content,R.value.level,H.value):await q(R.value.name,R.value.content,R.value.level,H.value),200===e.code&&(I.getList(),I.closeDialog()),A.value=!1}else A.value=!1}))})(B.value)),loading:A.value},{default:t((()=>[g(b(i(D)("task.save")),1)])),_:1},8,["loading"])])),_:1})])),_:1})])),_:1})])),_:1},8,["model","rules"]))}});export{D as _};
