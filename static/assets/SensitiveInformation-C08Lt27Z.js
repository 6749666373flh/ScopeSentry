import{d as e,r as t,s as a,e as l,P as o,E as i,H as r,F as s,K as n,o as p,c as m,a as d,w as u,N as c,f,t as g,y as v,O as y,l as h,_ as x}from"./index-B4Nyjh3H.js";import{u as j}from"./useTable-CG-SPGP0.js";import{E as b}from"./el-card-wk8kGoMw.js";import{E as _}from"./el-select-ErNzBCXo.js";import{E as w}from"./el-tag-DS_6W9-f.js";import"./el-popper-DBt0ZFPB.js";import{E as S,a as k}from"./el-col-ChTZtubL.js";import{E}from"./el-drawer-CXrmM74L.js";import{E as z,a as A}from"./el-table-column-D5fUDOpn.js";import"./el-checkbox-DAPJr8Xi.js";import"./el-tooltip-l0sNRNKZ.js";import{_ as C}from"./Dialog.vue_vue_type_style_index_0_lang-bTolZCeI.js";import{_ as L}from"./Table.vue_vue_type_script_lang-DkXax4KK.js";import{u as H}from"./useCrudSchemas-C24QrNmN.js";import{l as P,m as I,n as U}from"./index-BS_iuBaF.js";import W from"./Csearch-BRD7XYf_.js";import"./useInput-Drsa8fv-.js";import"./index-ThnV7dxG.js";import"./isEqual-DFD3TClT.js";import"./debounce-4WtFbZlf.js";import"./isArrayLikeObject-CWayLN3s.js";import"./raf-jjs8tbGM.js";import"./refs-CGmkSrb7.js";import"./el-image-viewer-CLYRUyY9.js";import"./tsxHelper-TQdELaO0.js";import"./el-dropdown-item-BheZ-il5.js";import"./castArray-BrlE0VBR.js";import"./index-xQ3iUQKd.js";import"./tree-BfZhwLPs.js";import"./index-CdbOSPly.js";import"./ContentWrap.vue_vue_type_script_setup_true_lang-BgCcO80c.js";import"./el-text-D_MjvMVh.js";import"./el-divider-C1wqG4VS.js";import"./el-tree-select-C06mNOXK.js";import"./index-CdW5lxxY.js";import"./useIcon-DitchYFS.js";import"./exportData.vue_vue_type_script_setup_true_lang-wnjOG-ih.js";import"./el-tab-pane-Dsdbtla6.js";import"./el-form-DDCfLIJB.js";import"./el-radio-group-exGM2d1B.js";import"./el-space-D7hoWy8Y.js";const N={style:{whiteSpace:"pre-line"}},O=["onClick"];const R=x(e({__name:"SensitiveInformation",props:{projectList:{}},setup(e){const{t:x}=h(),R=[{keyword:"url",example:'url="http://example.com"',explain:x("searchHelp.url")},{keyword:"sname",example:'sname="twilio_account_sid"',explain:x("searchHelp.sname")},{keyword:"body",example:'body="api-key-example"',explain:x("searchHelp.body")},{keyword:"info",example:'info="api-key-example"',explain:x("searchHelp.sinfo")},{keyword:"project",example:'project="Hackerone"',explain:x("searchHelp.project")},{keyword:"md5",example:'md5=="1d49e5e190f7a38ab498e28e6578f64f"',explain:x("searchHelp.sensMd5")},{keyword:"level",example:'level=="rad"',explain:x("searchHelp.sensLevel")}],T=t(""),D=e=>{T.value=e,ue()},V=a([{field:"selection",type:"selection",minWidth:"55"},{field:"index",label:x("tableDemo.index"),type:"index",minWidth:55},{field:"url",label:"URL",minWidth:200},{field:"name",label:x("sensitiveInformation.sensitiveName"),minWidth:150},{field:"color",label:"Level",minWidth:50,columnKey:"color",formatter:(e,t,a)=>{if(a)return l(o,{icon:"clarity:circle-solid",color:a,style:"transform: translateY(-35%)"},null)},filters:[{text:"Red",value:"red"},{text:"Green",value:"green"},{text:"Cyan",value:"cyan"},{text:"Yellow",value:"yellow"},{text:"Orange",value:"orange"},{text:"Gray",value:"gray"},{text:"Pink",value:"pink"},{text:"Null",value:"null"}]},{field:"match",label:"Info",minWidth:150,formatter:(e,t,a)=>{if(!a)return;const o=a.map(((e,t)=>l("div",{key:t},[e])));return l(i,{height:"100px"},{default:()=>[l("div",{class:"scrollbar-demo-item"},[o])]})}},{field:"time",label:x("asset.time"),minWidth:200},{field:"action",label:x("tableDemo.action"),formatter:(e,t,a)=>{if(e.body_id){let t;return l(s,null,[l(r,{type:"primary",onClick:()=>ie(e.body_id)},(o=t=x("asset.detail"),"function"==typeof o||"[object Object]"===Object.prototype.toString.call(o)&&!y(o)?t:{default:()=>[t]}))])}var o},minWidth:100}]),F=a({}),{allSchemas:K}=H(V),{tableRegister:M,tableState:q,tableMethods:$}=j({fetchDataApi:async()=>{const{currentPage:e,pageSize:t}=q,a=await I(T.value,e.value,t.value,F);return{list:a.data.list,total:a.data.total}},immediate:!1}),{loading:G,dataList:Y,total:B,currentPage:X,pageSize:J}=q,{getList:Q,getElTableExpose:Z}=$;function ee(){return{background:"var(--el-fill-color-light)"}}Q(),n((()=>{ae(),window.addEventListener("resize",ae)}));const te=t(0),ae=()=>{const e=window.innerHeight||document.documentElement.clientHeight;te.value=.7*e},le=t(!1),oe=t(""),ie=async e=>{e.replace("md5==","");const t=await P(e);oe.value=t.data.body,le.value=!0},re=async e=>{Object.assign(F,e),ue()},se=(e,t)=>{Object.assign(F,t),T.value=e,ue()},ne=t(!1),pe=()=>{ne.value=!0},me=t([]),de=async()=>{try{const e=await U(T.value,F);e&&e.data&&Array.isArray(e.data.list)&&(me.value=e.data.list.map((e=>({name:e.name,color:e.color,count:e.count}))))}catch(e){}};de();const ue=async()=>{try{await Promise.all([Q(),de()])}catch(e){}},ce=t([]),fe=e=>{if(ce.value){const[t,a]=e.split("=");t in F&&Array.isArray(F[t])&&(F[t]=F[t].filter((e=>e!==a)),0===F[t].length&&delete F[t]),ce.value=ce.value.filter((t=>t!==e))}};return(e,t)=>(p(),m(s,null,[l(W,{getList:d(Q),handleSearch:D,searchKeywordsData:R,index:"SensitiveResult",getElTableExpose:d(Z),handleFilterSearch:se,projectList:e.$props.projectList,openAggregation:pe,dynamicTags:ce.value,handleClose:fe},null,8,["getList","getElTableExpose","projectList","dynamicTags"]),l(d(k),null,{default:u((()=>[l(d(S),null,{default:u((()=>[l(d(b),null,{default:u((()=>[l(d(L),{pageSize:d(J),"onUpdate:pageSize":t[0]||(t[0]=e=>c(J)?J.value=e:null),currentPage:d(X),"onUpdate:currentPage":t[1]||(t[1]=e=>c(X)?X.value=e:null),columns:d(K).tableColumns,data:d(Y),stripe:"",rowKey:"_id",border:!0,"max-height":te.value,loading:d(G),resizable:!0,onRegister:d(M),onFilterChange:re,headerCellStyle:ee,"tooltip-options":{offset:1,showArrow:!1,effect:"dark",enterable:!0,showAfter:0,popperOptions:{},popperClass:"test",placement:"top",hideAfter:0,disabled:!1},style:{fontFamily:"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji"}},null,8,["pageSize","currentPage","columns","data","max-height","loading","onRegister"])])),_:1})])),_:1}),l(d(S),{":span":24},{default:u((()=>[l(d(b),null,{default:u((()=>[l(d(_),{pageSize:d(J),"onUpdate:pageSize":t[2]||(t[2]=e=>c(J)?J.value=e:null),currentPage:d(X),"onUpdate:currentPage":t[3]||(t[3]=e=>c(X)?X.value=e:null),"page-sizes":[10,20,50,100,200,500,1e3],layout:"total, sizes, prev, pager, next, jumper",total:d(B)},null,8,["pageSize","currentPage","total"])])),_:1})])),_:1})])),_:1}),l(d(C),{modelValue:le.value,"onUpdate:modelValue":t[4]||(t[4]=e=>le.value=e),title:d(x)("asset.detail"),center:"",style:{"border-radius":"15px","box-shadow":"5px 5px 10px rgba(0, 0, 0, 0.3)"},width:"70%","max-height":te.value},{default:u((()=>[l(d(i),{"max-height":te.value},{default:u((()=>[f("div",N,g(oe.value),1)])),_:1},8,["max-height"])])),_:1},8,["modelValue","title","max-height"]),l(d(E),{modelValue:ne.value,"onUpdate:modelValue":t[5]||(t[5]=e=>ne.value=e),title:d(x)("sensitiveInformation.sensAggre"),direction:"rtl",size:"30%"},{default:u((()=>[l(d(z),{data:me.value},{default:u((()=>[l(d(A),{prop:"name",label:d(x)("sensitiveInformation.sensitiveName"),width:"180"},{default:u((e=>[f("div",{style:{display:"flex","align-items":"center"},onClick:t=>((e,t)=>{const a=`${e}=${t}`;ce.value=[...ce.value,a]})("sname",e.row.name)},[l(d(w),null,{default:u((()=>[v(g(e.row.name),1)])),_:2},1024)],8,O)])),_:1},8,["label"]),l(d(A),{prop:"color",label:"color",width:"180"},{default:u((e=>[l(d(w),{color:e.row.color,round:"",effect:"plain",size:"small",style:{width:"20px"}},null,8,["color"])])),_:1}),l(d(A),{prop:"count",label:d(x)("common.quantity"),width:"180"},null,8,["label"])])),_:1},8,["data"])])),_:1},8,["modelValue","title"])],64))}}),[["__scopeId","data-v-ca45c35e"]]);export{R as default};
